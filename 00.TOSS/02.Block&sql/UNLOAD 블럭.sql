WITH TMP_SQL AS (
SELECT
TABLE_NAME
,COMMENTS
,\u0027SELECT /*+ PARALLEL(4) */ \u0027\u0027$$[V_DATE]\u0027\u0027 AS BASE_DT, \u0027\u0027\u0027||TABLE_NAME||\u0027\u0027\u0027 AS TBL_NM, COUNT(1) AS CNT FROM CBSOWN.\u0027||\u0027C\u0027||SUBSTR(TABLE_NAME,2) AS SQL_CNT
, ROW_NUMBER() OVER(ORDER BY 1) AS RN
FROM ALL_TAB_COMMENTS A
WHERE OWNER \u003d \u0027SOROWN\u0027
AND LENGTH(TABLE_NAME) \u003d 13
AND TABLE_NAME NOT IN (\u0027DOPCO_SORVL_L\u0027)
AND TABLE_NAME NOT LIKE \u0027DRU%\u0027
AND TABLE_NAME NOT LIKE \u0027DI%\u0027
AND TABLE_NAME NOT LIKE \u0027%P\u0027
AND COMMENTS LIKE \u0027DOP%\u0027
AND TABLE_NAME NOT IN ($$[IN_CBS_01_DOP])
AND ( (\u0027N\u0027 \u003d \u0027$$[V_LD_CHK]\u0027)
OR (\u0027Y\u0027 \u003d \u0027$$[V_LD_CHK]\u0027
AND TABLE_NAME IN (
  SELECT DISTINCT
   SUBSTR(L.MIS_BTCH_PROG_ID,5,13)
   FROM ADMOWN.WATCO_PULOG_L L
  WHERE L.JOB_BASE_DT \u003d \u0027$$[V_DATE]\u0027
   AND L.MIS_BTCH_PROG_ID LIKE \u0027L%\u0027
   )
)
)
ORDER BY COMMENTS
)
SELECT
   (SELECT \u0027SELECT NULL,NULL,0 FROM DUAL WHERE 1\u003d0\u0027||CHR(10) FROM DUAL)
|| TO_CLOB((SELECT LISTAGG(\u0027UNION ALL \u0027||SQL_CNT, CHR(10))||CHR(10) FROM TMP_SQL WHERE RN BETWEEN 1 AND 30))
|| TO_CLOB((SELECT LISTAGG(\u0027UNION ALL \u0027||SQL_CNT, CHR(10))||CHR(10) FROM TMP_SQL WHERE RN BETWEEN 31 AND 60))
|| TO_CLOB((SELECT LISTAGG(\u0027UNION ALL \u0027||SQL_CNT, CHR(10))||CHR(10) FROM TMP_SQL WHERE RN BETWEEN 61 AND 90))
|| TO_CLOB((SELECT LISTAGG(\u0027UNION ALL \u0027||SQL_CNT, CHR(10))||CHR(10) FROM TMP_SQL WHERE RN BETWEEN 91 AND 120))
|| TO_CLOB((SELECT LISTAGG(\u0027UNION ALL \u0027||SQL_CNT, CHR(10))||CHR(10) FROM TMP_SQL WHERE RN BETWEEN 121 AND 150))
|| TO_CLOB((SELECT LISTAGG(\u0027UNION ALL \u0027||SQL_CNT, CHR(10))||CHR(10) FROM TMP_SQL WHERE RN BETWEEN 151 AND 180))
|| TO_CLOB((SELECT LISTAGG(\u0027UNION ALL \u0027||SQL_CNT, CHR(10))||CHR(10) FROM TMP_SQL WHERE RN BETWEEN 181 AND 210))
AS SQL_CNT
FROM DUAL